(this.webpackJsonphohcssignup=this.webpackJsonphohcssignup||[]).push([[0],{60:function(e,t,a){e.exports=a(91)},91:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(30),r=a.n(c),o=a(21),s=a(15),u=a(5),m=a(9),i=a(7),d=a(24),p=a(11);var E=function(){var e=Object(n.useState)("false"),t=Object(u.a)(e,2),a=t[0],c=t[1];return console.log("render"),l.a.createElement(d.a,{bg:"primary",variant:"dark"},l.a.createElement(d.a.Brand,{href:"/"},"\u9748\u5be6\u54e1\u5de5\u57f9\u8a13\u8ab2\u7a0b\u5831\u540d\u7cfb\u7d71"),l.a.createElement(i.a,{className:"mr-auto"},l.a.createElement(i.a.Link,{href:"/register-record"},"\u5831\u540d\u8a18\u9304")),l.a.createElement(m.a,{variant:"outline-light",onClick:function(){fetch("/logout",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){if(200!==e.status)return"error";console.log("Logout now"),alert("\u767b\u51fa\u6210\u529f"),localStorage.clear(),c("true")})).catch((function(e){console.log("Login: "+e)}))}},"\u767b\u51fa"),"true"===a&&l.a.createElement(p.a,{to:"/login"}))},f=a(17);var h=function(e){return l.a.createElement("footer",null,localStorage.getItem("isAdmin")&&l.a.createElement(f.b,{to:"/admin",className:"adminLink"},"\u7ba1\u7406\u54e1\u6a21\u5f0f"))},g=a(3),b=a(25),N=a(19),j=a(10),v=a.n(j);var O=function(){var e=Object(n.useState)([{}]),t=Object(u.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)({username:"",email:"",staffid:"",post:"",dept:"",course:""}),i=Object(u.a)(r,2),d=i[0],p=i[1],f=Object(n.useState)(!1),j=Object(u.a)(f,2),O=j[0],C=j[1],y=["\u59d3\u540d","\u96fb\u90f5","\u8077\u54e1\u7de8\u865f","\u8077\u4f4d","\u55ae\u4f4d","\u5831\u8b80\u8ab2\u7a0b"],S="";function w(){var e=d.course.split(" ");console.log("date: "+e[1]);var t=d.course.split(" ")[0],a=d.course.split(" ")[1],n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseName:t,courseDate:a})};fetch("/checkQuota",n).then((function(e){return 200===e.status?e.json():(alert("\u767c\u751f\u932f\u8aa4\uff0c\u8acb\u7a0d\u5f8c\u518d\u5617\u8a66"),"error")})).then((function(e){console.log(e),0===e.quota?function(e,t){var a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseName:e,courseDate:t,enrollment:d,registeredBy:localStorage.getItem("username")})};fetch("/waitinglist",a).then((function(e){200===e.status?(alert("\u8ab2\u7a0b\u540d\u984d\u66ab\u6eff\uff0c\u4f60\u5c07\u6703\u52a0\u9032\u5f8c\u5099\u540d\u55ae\u3002\u5982\u6700\u5f8c\u80fd\u5920\u6210\u529f\u5831\u8b80\uff0c\u5c46\u6642\u5c07\u6703\u4ee5\u516c\u53f8\u96fb\u90f5\u901a\u77e5"),L()):alert("\u767c\u751f\u932f\u8aa4\uff0c\u8acb\u7a0d\u5f8c\u518d\u5617\u8a66")})).catch((function(e){console.log("waitinglist: "+e)}))}(t,a):"error"!==e&&(console.log("Enrolled"),function(e){console.log(e);var t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseID:e._id,enrollment:d,registeredBy:localStorage.getItem("username")})};fetch("/enroll",t).then((function(e){200===e.status?(alert("\u6210\u529f\u5831\u8b80\u8ab2\u7a0b"),L()):alert("\u672a\u80fd\u6210\u529f\u5831\u8b80\u8ab2\u7a0b, \u8acb\u7a0d\u5f8c\u518d\u5617\u8a66")})).catch((function(e){console.log("enroll: "+e)}))}(e))})).catch((function(e){console.log("Login: "+e)}))}function L(){p((function(e){return Object(s.a)(Object(s.a)({},e),{},{username:"",email:"",staffid:"",post:"",dept:"",course:""})}))}function T(e){var t=e.target,a=t.name,n=t.value;p((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},a,n))})),console.log(d)}return Object(n.useEffect)((function(){if(console.log("render"),!O){var e={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({username:localStorage.getItem("username")})};fetch("/user",e).then((function(e){return e.json()})).then((function(e){"admin"===(S=e.role)&&localStorage.setItem("isAdmin",!0),p({username:e.name,email:e.username,staffid:e.staffid,post:e.post,dept:e.dept,course:""})})).catch((function(e){console.log("user: "+e)}))}fetch("/futureCourse",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log("future Course"),e.length>0&&(console.log("CourseList[0]: "+e[0].courseName),c(e),p((function(t){var a=new Date(e[0].date).toLocaleDateString();return Object(s.a)(Object(s.a)({},t),{},{course:e[0].courseName+" "+a})})),console.log("DataObtained: "+O),console.log(a)),C(!0)})).catch((function(e){console.log("futureCourse: "+e)}))})),l.a.createElement("div",null,l.a.createElement(E,null),l.a.createElement("img",{src:"https://www.hohcs.org.hk/App/Modules/Admin/Tpl/Static/upload/image/20170418/20170418125117_21846.png",className:"formIcon"}),l.a.createElement(g.a,{className:"inputForm",onSubmit:function(e){e.preventDefault(),w()}},l.a.createElement("div",{className:"inputRow"},l.a.createElement("div",{className:"inputItem"},l.a.createElement(b.a,null,l.a.createElement(g.a.Label,{className:"inputLabel"},"\u540d\u7a31:"),l.a.createElement(g.a.Control,{placeholder:y[0],size:"lg",onChange:T,value:d.username,name:"username"}))),l.a.createElement("div",{className:"inputItem"}),l.a.createElement("div",{className:"inputItem"},l.a.createElement(b.a,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u96fb\u90f5:"),l.a.createElement(N.a,null,l.a.createElement(g.a.Control,{placeholder:y[1],size:"lg",name:"email",type:"text",onChange:T,value:d.email,className:"input"}),l.a.createElement(N.a.Append,null,l.a.createElement(N.a.Text,null,"@hohsc.org.hk")))))),l.a.createElement("div",{className:"inputRow"},l.a.createElement("div",{className:"inputItem"},l.a.createElement(b.a,null,l.a.createElement(g.a.Label,{className:"inputLabel"},"\u8077\u54e1\u7de8\u865f:"),l.a.createElement(g.a.Control,{placeholder:y[2],size:"lg",onChange:T,value:d.staffid,name:"staffid"}))),l.a.createElement("div",{className:"inputItem"}),l.a.createElement("div",{className:"inputItem"},l.a.createElement(b.a,null,l.a.createElement(g.a.Label,{className:"inputLabel"},"\u8077\u4f4d:"),l.a.createElement(g.a.Control,{placeholder:y[3],size:"lg",onChange:T,value:d.post,name:"post"})))),l.a.createElement("div",{className:"inputRow"},l.a.createElement("div",{className:"inputItem"},l.a.createElement(b.a,null,l.a.createElement(g.a.Label,{className:"inputLabel"},"\u55ae\u4f4d:"),l.a.createElement(g.a.Control,{placeholder:y[4],size:"lg",onChange:T,value:d.dept,name:"dept"}))),l.a.createElement("div",{className:"inputItem"}),l.a.createElement("div",{className:"inputItem"},l.a.createElement(b.a,null,l.a.createElement(g.a.Label,{className:"inputLabel"},"\u5831\u8b80\u8ab2\u7a0b:"),l.a.createElement(g.a.Control,{size:"lg",onChange:T,value:d.course,name:"course",as:"select"},l.a.createElement("option",null,"\u8acb\u9078\u64c7\u8ab2\u7a0b"),a.length>0&&a.map((function(e){var t=new Date(e.date);return l.a.createElement("option",null,e.courseName," ",t.toLocaleDateString())})))))),l.a.createElement("div",{className:"btnWrapper"},l.a.createElement(m.a,{variant:"primary",size:"lg",type:"submit",className:"submitBtn"},"\u63d0\u4ea4"),l.a.createElement(m.a,{variant:"danger",size:"lg",onClick:L,className:"clearBtn"},"\u6e05\u9664\u6240\u6709\u8cc7\u6599"))),l.a.createElement(h,{role:S}))};function C(){var e=Object(n.useState)({username:"",password:"",staffid:"",name:"",post:"",dept:""}),t=Object(u.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),i=Object(u.a)(r,2),d=i[0],E=i[1];function f(e){var t=e.target,n=t.name,l=t.value;c((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},n,l))})),console.log(a)}return l.a.createElement(l.a.Fragment,null,l.a.createElement("img",{src:"https://www.hohcs.org.hk/App/Modules/Admin/Tpl/Static/upload/image/20170418/20170418125117_21846.png",className:"icon-register"}),l.a.createElement(g.a,{onSubmit:function(e){e.preventDefault();var t={username:a.username,password:a.password,staffid:a.staffid,name:a.name,post:a.post,dept:a.dept},n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify(t)};fetch("/register",n).then((function(e){return 200===e.status?e.json():"error"})).then((function(e){"error"!==e?(localStorage.setItem("userToken",e.token),localStorage.setItem("isAuthorized",!0),localStorage.setItem("username",e.user.username),E(!0),console.log("Ready to redirect")):alert("\u672a\u80fd\u6210\u529f\u8a3b\u518a\uff0c\u8acb\u518d\u5617\u8a66")}))}},l.a.createElement(g.a.Group,{className:"inputGroup"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u96fb\u90f5:"),l.a.createElement(N.a,null,l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u96fb\u90f5",className:"input",name:"username",onChange:f,value:a.username}),l.a.createElement(N.a.Append,null,l.a.createElement(N.a.Text,null,"@hohsc.org.hk")))),l.a.createElement(g.a.Group,{className:"inputGroup"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u5bc6\u78bc:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u5bc6\u78bc",onChange:f,name:"password",value:a.password,type:"password",className:"input"})),l.a.createElement(g.a.Group,{className:"inputGroup"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u59d3\u540d:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u59d3\u540d",onChange:f,name:"name",value:a.name,type:"text",className:"input"})),l.a.createElement(g.a.Group,{className:"inputGroup"},l.a.createElement(g.a.Label,{className:"inputLabel"}," \u55ae\u4f4d:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u55ae\u4f4d",onChange:f,name:"dept",value:a.dept,type:"text",className:"input"})),l.a.createElement(g.a.Group,{className:"inputGroup"},l.a.createElement(g.a.Label,{className:"inputLabel"}," \u8077\u4f4d:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u8077\u4f4d",onChange:f,name:"post",value:a.post,type:"text",className:"input"})),l.a.createElement(g.a.Group,{className:"inputGroup"},l.a.createElement(g.a.Label,{className:"inputLabel"}," \u8077\u54e1\u7de8\u865f:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u8077\u54e1\u7de8\u865f",onChange:f,name:"staffid",value:a.staffid,type:"text",className:"input"})),l.a.createElement(m.a,{variant:"primary",size:"lg",className:"registerBtn",type:"submit"},"\u8a3b\u518a"),d&&l.a.createElement(p.a,{to:"/"})))}var y=a(36),S=function(e){var t=e.component,a=Object(y.a)(e,["component"]);return l.a.createElement(p.b,Object.assign({},a,{render:function(e){return localStorage.getItem("isAuthorized")?l.a.createElement(t,e):l.a.createElement(p.a,{to:"/login"})}}))},w=function(e){var t=e.component,a=Object(y.a)(e,["component"]);return l.a.createElement(p.b,Object.assign({},a,{render:function(e){return localStorage.getItem("isAdmin")?(console.log("isAdmin? "+localStorage.getItem("isAdmin")),l.a.createElement(t,e)):l.a.createElement(p.a,{to:"/"})}}))},L=a(57),T=a(58),I=new(function(){function e(){Object(L.a)(this,e),this.authenticated=!1}return Object(T.a)(e,[{key:"login",value:function(e){this.authenticated=!0,e()}},{key:"logout",value:function(e){this.authenticated=!1,e()}},{key:"isAuthenticated",value:function(){return this.authenticated}}]),e}());var A=function(){console.log("Login IN page, IS authenticated? "+I.isAuthenticated());var e=Object(n.useState)({username:"",password:""}),t=Object(u.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)({to:"",isDirected:null}),i=Object(u.a)(r,2),d=i[0],E=i[1],h=Object(n.useState)(!1),b=Object(u.a)(h,2),j=b[0],O=b[1];if(localStorage.getItem("isAuthorized"))return l.a.createElement(p.a,{to:"/"});function C(e){var t=e.target,n=t.name,l=t.value;c((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},n,l))})),console.log(a)}return l.a.createElement(l.a.Fragment,null,l.a.createElement("img",{src:"https://www.hohcs.org.hk/App/Modules/Admin/Tpl/Static/upload/image/20170418/20170418125117_21846.png",className:"icon"}),j&&l.a.createElement("p",{className:"loginError"},"\u767b\u5165\u96fb\u90f5\u6216\u5bc6\u78bc\u932f\u8aa4\uff0c\u8acb\u91cd\u65b0\u8f38\u5165"),l.a.createElement(g.a,{onSubmit:function(e){var t={username:a.username,password:a.password};e.preventDefault();var n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify(t)};fetch("/login",n).then((function(e){return 200===e.status?e.json():"error"})).then((function(e){"error"!==e?(console.log(e),localStorage.setItem("userToken",e.token),localStorage.setItem("isAuthorized",!0),localStorage.setItem("username",e.user.username),console.log("Ready to redirect"),E({to:"/",isDirected:!0})):(O(!0),c({username:"",password:""}))})).catch((function(e){console.log("Login: "+e)}))},className:"formInput"},l.a.createElement(N.a,{className:"loginInput"},l.a.createElement(g.a.Control,{placeholder:"\u96fb\u90f5",className:"input",name:"username",onChange:C,value:a.username}),l.a.createElement(N.a.Append,null,l.a.createElement(N.a.Text,{className:"emailText"},"@hohsc.org.hk"))),l.a.createElement(g.a.Group,{className:"loginInput"},l.a.createElement(g.a.Control,{placeholder:"\u5bc6\u78bc",onChange:C,name:"password",value:a.password,type:"password"})),l.a.createElement(m.a,{variant:"primary",size:"lg",className:"loginBtn",type:"submit"},"\u767b\u5165"),l.a.createElement("p",{className:"remindText"},"\u5982\u672a\u66fe\u8a3b\u518a\uff0c\u8acb\u5148\u8a3b\u518a\u3002"),l.a.createElement(f.b,{to:"/register"},l.a.createElement(m.a,{variant:"secondary",size:"lg",className:"registerBtn"},"\u8a3b\u518a"))),d.isDirected&&l.a.createElement(p.a,{to:d.to}))};function k(){return l.a.createElement(d.a,{bg:"primary",variant:"dark"},l.a.createElement(d.a.Brand,{href:"/admin"},"\u8ab2\u7a0b\u5831\u540d\u7cfb\u7d71"),l.a.createElement(i.a,{className:"mr-auto"},l.a.createElement(i.a.Link,{href:"/createcourse"},"\u65b0\u589e\u8ab2\u7a0b"),l.a.createElement(i.a.Link,{href:"/history"},"\u4ee5\u5f80\u8ab2\u7a0b"),l.a.createElement(i.a.Link,{href:"/admin"},"\u4eca\u5929\u8ab2\u7a0b"),l.a.createElement(i.a.Link,{href:"/future"},"\u672a\u4f86\u8ab2\u7a0b")),l.a.createElement(i.a,null,l.a.createElement(i.a.Link,{href:"/"},"\u8fd4\u56de\u5831\u540d\u8868\u683c")))}var D=a(8),x=a(27);function B(e){console.log(e.course);var t=e.courseID,a=Object(n.useState)(!1),c=Object(u.a)(a,2),r=c[0],o=c[1],s=Object(n.useState)([]),i=Object(u.a)(s,2),d=i[0],p=i[1];return Object(n.useEffect)((function(){var e={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseID:t})};fetch("/waitinglistByCourseID",e).then((function(e){return e.json()})).then((function(e){console.log(e.records[0].staffid),0===d.length&&p(e.records)}))})),r?l.a.createElement(_,{courseDetail:e.courseDetail,course:e.course}):l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,{className:"detailCard"},l.a.createElement(D.a.Header,{className:"enrollHeaderWrapper"},l.a.createElement(m.a,{className:"backBtn",onClick:function(){o(!0)}},"\u8fd4\u56de\u67e5\u770b\u5831\u540d\u540d\u55ae"),l.a.createElement("h1",{className:"enrollDetailTitle"},e.courseDetail.courseName," (\u5f8c\u88dc\u540d\u55ae)")),l.a.createElement(D.a.Body,null,l.a.createElement(x.a,{striped:!0,bordered:!0,hover:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"\u8077\u54e1\u7de8\u865f"),l.a.createElement("th",null,"\u59d3\u540d"),l.a.createElement("th",null,"\u96fb\u90f5"),l.a.createElement("th",null,"\u55ae\u4f4d"),l.a.createElement("th",null,"\u8077\u4f4d"))),l.a.createElement("tbody",null,d&&d.map((function(e){return l.a.createElement("tr",null,l.a.createElement("td",null,e.staffid),l.a.createElement("td",null,e.username),l.a.createElement("td",null,e.email),l.a.createElement("td",null,e.dept),l.a.createElement("td",null,e.post))})))),l.a.createElement("p",null,"\u7e3d\u5f8c\u88dc\u4eba\u6578\uff1a ",d&&d.length))))}function _(e){console.log(e.courseDetail);var t=Object(n.useState)([]),a=Object(u.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(!1),s=Object(u.a)(o,2),i=s[0],d=s[1],p=Object(n.useState)(!1),E=Object(u.a)(p,2),f=E[0],h=E[1];return Object(n.useEffect)((function(){r(e.courseDetail.records)})),f?l.a.createElement(G,{selectedCourse:e.course}):i?(console.log(e.course._id),l.a.createElement(B,{courseID:e.course._id,courseDetail:e.courseDetail,course:e.course})):l.a.createElement(D.a,{className:"detailCard"},l.a.createElement(D.a.Header,{className:"enrollHeaderWrapper"},l.a.createElement(m.a,{className:"backBtn",onClick:function(){h(!0)}},"\u8fd4\u56de\u67e5\u770b\u8ab2\u7a0b\u8cc7\u6599"),l.a.createElement("h1",{className:"enrollDetailTitle"},e.courseDetail.courseName),l.a.createElement(m.a,{className:"waitinglistBtn",onClick:function(){d(!0)}},"\u67e5\u770b\u5f8c\u88dc\u540d\u55ae")),l.a.createElement(D.a.Body,null,l.a.createElement(x.a,{striped:!0,bordered:!0,hover:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"\u8077\u54e1\u7de8\u865f"),l.a.createElement("th",null,"\u59d3\u540d"),l.a.createElement("th",null,"\u96fb\u90f5"),l.a.createElement("th",null,"\u55ae\u4f4d"),l.a.createElement("th",null,"\u8077\u4f4d"))),l.a.createElement("tbody",null,c&&c.map((function(e){return l.a.createElement("tr",null,l.a.createElement("td",null,e.staffid),l.a.createElement("td",null,e.username),l.a.createElement("td",null,e.email),l.a.createElement("td",null,e.dept),l.a.createElement("td",null,e.post))})))),l.a.createElement("p",null,"\u7e3d\u5831\u540d\u4eba\u6578\uff1a ",c&&c.length)))}function G(e){var t;console.log("CourseDetail"),e.selectedCourse&&(t=new Date(e.selectedCourse.date));var a=Object(n.useState)(!1),c=Object(u.a)(a,2),r=c[0],o=c[1],s=Object(n.useState)({}),i=Object(u.a)(s,2),d=i[0],p=i[1];return r?l.a.createElement(_,{courseDetail:d,course:e.selectedCourse}):l.a.createElement("div",null,console.log(r),l.a.createElement(D.a,{className:"detailCard"},l.a.createElement(D.a.Header,{className:"cardDetailWrapper"},l.a.createElement("h1",{className:"courseTitle"},e.selectedCourse&&e.selectedCourse.courseName),l.a.createElement(m.a,{variant:"danger",className:"deleteBtn",onClick:function(){var t=e.selectedCourse._id,a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseID:t})};fetch("/deleteCourse",a).then((function(e){200===e.status?(alert("\u6210\u529f\u522a\u9664\u8ab2\u7a0b"),window.location.reload(!0)):alert("\u767c\u751f\u932f\u8aa4\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66")}))}},"\u522a\u9664\u8ab2\u7a0b")),l.a.createElement(D.a.Body,null,l.a.createElement(D.a.Title,{className:"courseDescription"},e.selectedCourse&&e.selectedCourse.description),l.a.createElement(D.a.Text,{className:"courseInfo"},"\u4e0a\u8ab2\u65e5\u671f: ",t&&t.toLocaleDateString()," ",e.selectedCourse&&e.selectedCourse.time),l.a.createElement(D.a.Text,{className:"courseInfo"},"\u4e0a\u8ab2\u5730\u9ede: ",e.selectedCourse&&e.selectedCourse.venue),l.a.createElement(D.a.Text,{className:"courseInfo"},"\u8ab2\u7a0b\u5c0e\u5e2b: ",e.selectedCourse&&e.selectedCourse.tutor),l.a.createElement(D.a.Text,{className:"courseInfo"},"\u5c1a\u9918\u540d\u984d: ",e.selectedCourse&&e.selectedCourse.quota),l.a.createElement(m.a,{variant:"primary",className:"adminEnrollRecordBtn",onClick:function(){var t=e.selectedCourse._id,a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseID:t})};fetch("/enrollDetail",a).then((function(e){return e.json()})).then((function(e){console.log(e),"\u672a\u6709\u5831\u540d\u8a18\u9304"===e.message?alert(e.message):(o(!0),p(e))}))}},"\u67e5\u770b\u5831\u540d\u60c5\u6cc1"))))}function z(){var e=[{_id:"",couseName:"",date:"",time:"",venue:"",quota:0,tutor:"",description:""}],t=Object(n.useState)(e),a=Object(u.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(""),s=Object(u.a)(o,2),m=s[0],d=s[1],p=Object(n.useState)(e[0]),E=Object(u.a)(p,2),f=E[0],h=E[1];return Object(n.useEffect)((function(){fetch("/adminTodayCourse",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){c===e&&r(t)})),h(c.find((function(e){return e._id===m})))})),l.a.createElement("div",null,l.a.createElement(k,null),l.a.createElement("div",{className:"sidebar"},l.a.createElement("h4",{className:"sidebarTitle"},"\u4eca\u5929\u8ab2\u7a0b"),l.a.createElement(i.a,{defaultActiveKey:"",className:"flex-column",onSelect:function(e){return d(e)}},c.map((function(e){var t=new Date(e.date);return l.a.createElement(i.a.Link,{eventKey:e._id,className:"courseLink"},e.courseName," ",t.toLocaleDateString())})),0===c.length&&l.a.createElement("p",{className:"noCourse"},"\u4eca\u5929\u6c92\u6709\u8ab2\u7a0b"))),m&&l.a.createElement(G,{selectedCourse:f}))}var P=a(34);function K(){var e=Object(n.useState)({courseName:"",date:"",time:"",venue:"",quota:0,tutor:"",description:""}),t=Object(u.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),i=Object(u.a)(r,2),d=i[0],E=i[1];function f(e){var t=e.target,a=t.name,n=t.value;c((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},a,n))}))}return l.a.createElement(l.a.Fragment,null,l.a.createElement(k,null),l.a.createElement("h1",{className:"createCourseTitle"},"\u65b0\u589e\u8ab2\u7a0b"),l.a.createElement(g.a,{onSubmit:function(e){e.preventDefault();var t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify(a)};fetch("/createcourse",t).then((function(e){e&&(alert("\u6210\u529f\u65b0\u589e\u8ab2\u7a0b"),E(!0))}))}},l.a.createElement("div",{className:"inputForm"},l.a.createElement("div",{className:"inputRow"},l.a.createElement(g.a.Group,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u8ab2\u7a0b\u540d\u7a31:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u8ab2\u7a0b\u540d\u7a31",className:"input",name:"courseName",type:"text",onChange:f,value:a.cousreName})),l.a.createElement("div",{className:"inputItem"}),l.a.createElement(g.a.Group,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u4e0a\u8ab2\u65e5\u671f:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u4e0a\u8ab2\u65e5\u671f",className:"input",name:"date",type:"date",onChange:f,value:a.date}))),l.a.createElement("div",{className:"inputRow"},l.a.createElement(g.a.Group,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u4e0a\u8ab2\u6642\u9593:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u4e0a\u8ab2\u6642\u9593",className:"input",name:"time",type:"time",onChange:f,value:a.time})),l.a.createElement("div",{className:"inputItem"}),l.a.createElement(g.a.Group,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u4e0a\u8ab2\u5730\u9ede:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u4e0a\u8ab2\u5730\u9ede",className:"input",name:"venue",type:"text",onChange:f,value:a.venue}))),l.a.createElement("div",{className:"inputRow"},l.a.createElement(g.a.Group,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u8ab2\u7a0b\u540d\u984d:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u8ab2\u7a0b\u540d\u984d",className:"input",name:"quota",type:"number",onChange:f,value:a.quota})),l.a.createElement("div",{className:"inputItem"}),l.a.createElement(g.a.Group,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel"},"\u8ab2\u7a0b\u5c0e\u5e2b:"),l.a.createElement(g.a.Control,{placeholder:"\u8acb\u8f38\u5165\u8ab2\u7a0b\u5c0e\u5e2b",className:"input",name:"tutor",type:"text",onChange:f,value:a.tutor}))),l.a.createElement("div",{className:"inputRow"},l.a.createElement(g.a.Group,{className:"inputItem"},l.a.createElement(g.a.Label,{className:"inputLabel courseDescriptionText"},"\u8ab2\u7a0b\u7c21\u4ecb:"),l.a.createElement(P.a,{as:"textarea","aria-label":"With textarea",rows:"4",name:"description",onChange:f,value:a.description}))),l.a.createElement(m.a,{variant:"primary",size:"lg",className:"createBtn",type:"submit"},"\u65b0\u589e\u8ab2\u7a0b"),d&&l.a.createElement(p.a,{to:"/admin"}))))}function F(){var e=[{_id:"",couseName:"",date:"",time:"",venue:"",quota:0,tutor:"",description:""}],t=Object(n.useState)(e),a=Object(u.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(""),s=Object(u.a)(o,2),m=s[0],d=s[1],p=Object(n.useState)(e[0]),E=Object(u.a)(p,2),f=E[0],h=E[1];return Object(n.useEffect)((function(){fetch("/adminPastCourse",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){c===e&&r(t)})),h(c.find((function(e){return e._id===m})))})),l.a.createElement("div",null,l.a.createElement(k,null),l.a.createElement("div",{className:"sidebar"},l.a.createElement("h4",{className:"sidebarTitle"},"\u4ee5\u5f80\u8ab2\u7a0b"),l.a.createElement(i.a,{defaultActiveKey:"",className:"flex-column",onSelect:function(e){return d(e)}},c.map((function(e){var t=new Date(e.date);return l.a.createElement(i.a.Link,{eventKey:e._id,className:"courseLink"},e.courseName," ",t.toLocaleDateString())})),0===c.length&&l.a.createElement("p",{className:"noCourse"},"\u6c92\u6709\u904e\u5f80\u8ab2\u7a0b"))),m&&l.a.createElement(G,{selectedCourse:f}),");")}function R(){var e=[{_id:"",couseName:"",date:"",time:"",venue:"",quota:0,tutor:"",description:""}],t=Object(n.useState)(e),a=Object(u.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(""),s=Object(u.a)(o,2),m=s[0],d=s[1],p=Object(n.useState)(e[0]),E=Object(u.a)(p,2),f=E[0],h=E[1];return Object(n.useEffect)((function(){fetch("/adminFutureCourse",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){console.log(t),c===e&&r(t)})),h(c.find((function(e){return e._id===m})))})),l.a.createElement("div",null,l.a.createElement(k,null),l.a.createElement("div",{className:"sidebar"},l.a.createElement("h4",{className:"sidebarTitle"},"\u672a\u4f86\u8ab2\u7a0b"),l.a.createElement(i.a,{defaultActiveKey:"",className:"flex-column",onSelect:function(e){return d(e)}},c.map((function(e){var t=new Date(e.date);return l.a.createElement(i.a.Link,{eventKey:e._id,className:"courseLink"},e.courseName," ",t.toLocaleDateString())})),0===c.length&&l.a.createElement("p",{className:"noCourse"},"\u6c92\u6709\u672a\u4f86\u8ab2\u7a0b"))),m&&l.a.createElement(G,{selectedCourse:f}),");")}function q(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(),s=Object(u.a)(o,2),i=s[0],d=s[1],p=Object(n.useState)(""),E=Object(u.a)(p,2),f=E[0],h=E[1],g=Object(n.useState)(),b=Object(u.a)(g,2),N=b[0],j=b[1],O=Object(n.useState)(!1),C=Object(u.a)(O,2),y=C[0],S=C[1];return Object(n.useEffect)((function(){if(!c||f!==e.selectedCourse._id){h(e.selectedCourse._id);var t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseID:e.selectedCourse._id,username:localStorage.getItem("username")})};fetch("/register-record-waitinglist",t).then((function(e){return 403!==e.status?e.json():"error"})).then((function(e){"error"!==e?(j(!1),d(e)):(j(!0),d())})),r(!0),console.log("After isLoaded: "+c)}})),y?l.a.createElement(H,{selectedCourse:e.selectedCourse}):l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,{className:"detailCard"},l.a.createElement(D.a.Header,{className:"cardDetailWrapper"},l.a.createElement(m.a,{className:"backBtn",onClick:function(){S(!0)}},"\u8fd4\u56de\u67e5\u770b\u5831\u540d\u7d00\u9304"),l.a.createElement("h1",{className:"courseTitle"},e.selectedCourse&&e.selectedCourse.courseName)),l.a.createElement(D.a.Body,null,N&&l.a.createElement("p",null,"\u4f60\u4e26\u6c92\u6709\u6b64\u8ab2\u7a0b\u7684\u5f8c\u88dc\u5831\u540d\u7d00\u9304"),l.a.createElement(x.a,{striped:!0,bordered:!0,hover:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"\u8077\u54e1\u7de8\u865f"),l.a.createElement("th",null,"\u59d3\u540d"),l.a.createElement("th",null,"\u96fb\u90f5"),l.a.createElement("th",null,"\u55ae\u4f4d"),l.a.createElement("th",null,"\u8077\u4f4d"))),l.a.createElement("tbody",null,i&&i.map((function(e){return l.a.createElement("tr",null,l.a.createElement("td",null,e.staffid),l.a.createElement("td",null,e.username),l.a.createElement("td",null,e.email),l.a.createElement("td",null,e.dept),l.a.createElement("td",null,e.post))})))))))}function H(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(),s=Object(u.a)(o,2),i=s[0],d=s[1],p=Object(n.useState)(),E=Object(u.a)(p,2),f=E[0],h=E[1],g=Object(n.useState)(!1),b=Object(u.a)(g,2),N=b[0],j=b[1],O=Object(n.useState)(!1),C=Object(u.a)(O,2),y=C[0],S=C[1];return Object(n.useEffect)((function(){if(!N||c!==e.selectedCourse._id){r(e.selectedCourse._id);var t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({courseID:e.selectedCourse._id,username:localStorage.getItem("username")})};fetch("/register-record",t).then((function(e){return 403!==e.status?e.json():"error"})).then((function(e){"error"!==e?(h(!1),d(e)):(h(!0),d())})),j(!0),console.log("After isLoaded: "+N)}})),y?l.a.createElement(q,{selectedCourse:e.selectedCourse}):l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,{className:"detailCard"},l.a.createElement(D.a.Header,{className:"cardDetailWrapper"},l.a.createElement("h1",{className:"courseTitle"},e.selectedCourse&&e.selectedCourse.courseName),l.a.createElement(m.a,{className:"waitinglistBtn",onClick:function(){S(!0)}},"\u67e5\u770b\u5f8c\u88dc\u540d\u55ae")),l.a.createElement(D.a.Body,null,f&&l.a.createElement("p",null,"\u4f60\u4e26\u6c92\u6709\u6b64\u8ab2\u7a0b\u7684\u5831\u540d\u7d00\u9304"),l.a.createElement(x.a,{striped:!0,bordered:!0,hover:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"\u8077\u54e1\u7de8\u865f"),l.a.createElement("th",null,"\u59d3\u540d"),l.a.createElement("th",null,"\u96fb\u90f5"),l.a.createElement("th",null,"\u55ae\u4f4d"),l.a.createElement("th",null,"\u8077\u4f4d"))),l.a.createElement("tbody",null,i&&i.map((function(e){return l.a.createElement("tr",null,l.a.createElement("td",null,e.staffid),l.a.createElement("td",null,e.username),l.a.createElement("td",null,e.email),l.a.createElement("td",null,e.dept),l.a.createElement("td",null,e.post))})))))))}function W(){var e=[{_id:"",couseName:"",date:"",time:"",venue:"",quota:0,tutor:"",description:""}],t=Object(n.useState)(e),a=Object(u.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(),s=Object(u.a)(o,2),m=s[0],p=s[1],E=Object(n.useState)("\u4eca\u5929"),f=Object(u.a)(E,2),h=f[0],g=f[1],b=Object(n.useState)(!1),N=Object(u.a)(b,2),j=N[0],O=N[1],C=Object(n.useState)(!1),y=Object(u.a)(C,2),S=y[0],w=y[1];return Object(n.useEffect)((function(){if(!j){console.log("render");var t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:v.a.stringify({period:h})};fetch("/course-by-date",t).then((function(e){return e.json()})).then((function(t){console.log("length: "+t.length),0===t.length?(w(!0),r(e)):(t!==c&&r(t),w(!1))})),O(!0)}})),l.a.createElement(l.a.Fragment,null,l.a.createElement(d.a,{bg:"primary",variant:"dark"},l.a.createElement(d.a.Brand,{href:"/"},"\u9748\u5be6\u54e1\u5de5\u57f9\u8a13\u8ab2\u7a0b\u5831\u540d\u7cfb\u7d71"),l.a.createElement(i.a,{className:"mr-auto",defaultActiveKey:"",onSelect:function(e){return function(e){switch(console.log(e),e){case"0":g("\u904e\u5f80"),O(!1),p();break;case"1":g("\u4eca\u5929"),O(!1),p();break;case"2":g("\u672a\u4f86"),O(!1),p()}}(e)}},l.a.createElement(i.a.Link,{eventKey:"0"},"\u904e\u5f80\u8ab2\u7a0b"),l.a.createElement(i.a.Link,{eventKey:"1"},"\u4eca\u5929\u8ab2\u7a0b"),l.a.createElement(i.a.Link,{eventKey:"2"},"\u672b\u4f86\u8ab2\u7a0b"))),l.a.createElement("div",{className:"sidebar"},l.a.createElement("h4",{className:"sidebarTitle"},h,"\u8ab2\u7a0b"),console.log(S),S&&l.a.createElement("p",{className:"noCourse"},"\u66ab\u6c92\u6709\u8ab2\u7a0b"),l.a.createElement(i.a,{defaultActiveKey:"",className:"flex-column",onSelect:function(e){return function(e){p(e)}(e)}},!S&&c.map((function(e){var t=new Date(e.date);return l.a.createElement(i.a.Link,{eventKey:e._id,className:"courseLink"},e.courseName," ",t.toLocaleDateString())})))),m&&l.a.createElement(H,{selectedCourse:c.find((function(e){return e._id===m}))}))}var M=a(59),J=a.n(M);function Q(e){return Object(n.useEffect)((function(){console.log("App"),J.a.get("/isAuthenticated",{headers:{"Content-Type":"Application/json",Accept:"application/json",Authorization:"Bearer ".concat(localStorage.getItem("userToken"))}}).then((function(e){console.log("Authorizing"),localStorage.setItem("isAuthorized",!0)})).catch((function(e){console.log(e),localStorage.removeItem("isAuthorized")}))})),l.a.createElement(f.a,null,l.a.createElement(p.d,null,l.a.createElement(p.b,{component:A,exact:!0,path:"/login"}),l.a.createElement(S,{component:O,exact:!0,path:"/"}),l.a.createElement(w,{component:z,exact:!0,path:"/admin"}),l.a.createElement(w,{component:K,exact:!0,path:"/createcourse"}),l.a.createElement(w,{component:F,exact:!0,path:"/history"}),l.a.createElement(w,{component:R,exact:!0,path:"/future"}),l.a.createElement(p.b,{component:C,exact:!0,path:"/register"}),l.a.createElement(p.b,{component:W,exact:!0,path:"/register-record"})))}a(90);r.a.render(l.a.createElement(f.a,null,l.a.createElement(Q,null)),document.getElementById("root"))}},[[60,1,2]]]);
//# sourceMappingURL=main.cf9639d7.chunk.js.map